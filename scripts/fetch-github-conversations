#!/usr/bin/env python3
"""CLI wrapper to fetch multiple GitHub conversations (reads URLs from file or stdin)."""
import argparse
import sys


def main():
    parser = argparse.ArgumentParser(prog="fetch-github-conversations")
    parser.add_argument(
        "--file",
        help="Path to file with URLs (one per line). If omitted, read from stdin",
        default=None,
    )
    parser.add_argument("--cache-path", default=None)
    parser.add_argument("--updated-at", default=None)
    args = parser.parse_args()

    from doppiozero.utils.scripts_common import read_urls_from_stdin_or_file
    from doppiozero.fetch_github_conversations import fetch_github_conversations

    urls = read_urls_from_stdin_or_file(args.file)
    results = fetch_github_conversations(
        urls, cache_path=args.cache_path, updated_at=args.updated_at
    )
    import json

    print(json.dumps(results, indent=2))


if __name__ == "__main__":
    main()
