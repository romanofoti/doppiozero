#!/usr/bin/env python3
"""CLI wrapper for summarizing a GitHub conversation using the package summarizer."""
import argparse
import sys
from doppiozero.content_service import content_manager


def main():
    parser = argparse.ArgumentParser(prog="summarize-github-conversation")
    parser.add_argument("input", help="GitHub URL or owner/repo/type/number")
    parser.add_argument(
        "--executive-summary-prompt-path",
        required=True,
        help="Path to executive summary prompt file",
    )
    parser.add_argument("--cache-path", default=None, help="Cache root directory")
    parser.add_argument(
        "--updated-at", default=None, help="Only fetch if remote is newer than this ISO timestamp"
    )
    args = parser.parse_args()

    try:
        summary = content_manager.summarize(
            args.input,
            args.executive_summary_prompt_path,
            cache_path=args.cache_path,
            updated_at=args.updated_at,
        )
        print(summary)
    except Exception as e:
        print(f"Error: {e}", file=sys.stderr)
        sys.exit(1)


if __name__ == "__main__":
    main()
